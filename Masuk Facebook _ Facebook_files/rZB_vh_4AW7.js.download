if (self.CavalryLogger) { CavalryLogger.start_js(["uoHdG"]); }

__d("MFirefoxAppDetect",[],(function(a,b,c,d,e,f){function a(a,b){if(!navigator.mozApps){b();return}if(window.locationbar&&!window.locationbar.visible){a();return}if(navigator.mozApps.getSelf){var c=navigator.mozApps.getSelf();c.onsuccess=function(){c.result?a():b()};c.onerror=b}else b()}f.isFirefoxApp=a}),null);
__d("MPageHeaderLeft",["DOM","MFirefoxAppDetect","$"],(function(a,b,c,d,e,f){var g={};function h(a){if(!g.back_button){var c=b("$")("page");g.back_button=b("DOM").find(c,"a","back-button");g.menu_button=b("DOM").find(c,"a","menu-link")}a.show_back_button?(b("DOM").hide(g.menu_button),b("DOM").show(g.back_button)):(b("DOM").hide(g.back_button),b("DOM").show(g.menu_button))}a=function a(c){var d=window.navigator;d.standalone||g.isMozApp?h(c):g.isMozApp===void 0&&(g.lastConfig=c,b("MFirefoxAppDetect").isFirefoxApp(function(){g.isMozApp=!0,c===g.lastConfig&&(a(c),delete g.lastConfig)},function(){g.isMozApp=!1}))};f.main=a}),null);
__d("MPageHeaderRight",["DOM","Stratcom"],(function(a,b,c,d,e,f){function g(){return b("DOM").scry(document.body,"*","mChromeHeaderRight")[0]}f.setup=function(a){if(a){var c=g();c&&(b("DOM").setContent(c,a.node||""),b("Stratcom").listen("m:page:unload",null,function(a){b("Stratcom").removeCurrentListener(),b("DOM").setContent(c,"")}))}};f.getChromeHeaderRightContent=function(){var a=g();return a?Array.prototype.slice.call(a.childNodes):null}}),null);
__d("MHeadMeta",[],(function(a,b,c,d,e,f){"use strict";a={isExistsByName:function(a){return!!this.getByName(a)},getByName:function(a){if(document.querySelector)return document.querySelector('head meta[name="'+a+'"]');var b=document.head||document.getElementsByTagName("head")[0];if(!b)return null;b=b.getElementsByTagName("meta");for(var c=0;c<b.length;c++){var d=b[c],e=d.getAttribute("name");if(e===a)return d}return null}};e.exports=a}),null);
__d("RemoteDevice",["Banzai","Cookie","GeneratedLoggerUtils","MViewport","Run","isInIframe"],(function(a,b,c,d,e,f){var g=!1,h={init:function(c){if(!b("isInIframe")()&&!window.APP_ENABLED&&!window.FW_ENABLED){if(/\((?:iPad|iPhone|iPod(?: touch));/.test(navigator.userAgent)){var d=Math.min(screen.width,screen.height),e=Math.max(screen.width,screen.height);d&&e&&(b("Cookie").set("wd",d+"x"+e),b("Cookie").set("m_pixel_ratio",window.devicePixelRatio));c&&c.performHardwareDetection&&c.hashId!==null&&b("Run").onAfterLoad(function(){h.logHardwareInfo(c.hashId||"")});return}d=b("MViewport").getWidth();e=b("MViewport").getScreenHeight();if(!d||!e)return;a.DEFER_COOKIES||b("Cookie").set("wd",d+"x"+e)}},logHardwareInfo:function(a){if(g)return;g=!0;var c=document.createElement("canvas");if(!c)return;c=c.getContext("webgl")||c.getContext("experimental-webgl");if(!c)return;var d=c.getExtension("WEBGL_debug_renderer_info");if(!d)return;var e="unknown",f="unknown";d!=null&&(e=c.getParameter(d.UNMASKED_RENDERER_WEBGL),f=c.getParameter(d.UNMASKED_VENDOR_WEBGL));c=0;window.navigator&&(c=window.navigator.hardwareConcurrency);d=window.screen.width;var h=window.screen.height,i=Math.min(d,h);d=Math.max(d,h);h={gpu_renderer:e,gpu_vendor:f,logical_cpu_count:c,screen_width_pixel:i,screen_height_pixel:d,device_pixel_ratio:window.devicePixelRatio,hashid:a};b("GeneratedLoggerUtils").log("logger:MHardwareDetectorLoggerConfig",h,b("Banzai").VITAL)}};e.exports=h}),null);
__d("MViewportTracking",["invariant","DataAttributeUtils","DOM","FBJSON","MHome","MPopoverVisiblityTracker","MViewport","NavigationMetrics","Stratcom","Style","Vector","Visibility","VisibilityTrackingHelper","gkx","onAfterTTI","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g){"use strict";var h=97,i=200,j=new Map();a=function(){function a(){this.$2=[],this.debugConsole=!1,this.activeStories={},this.cachedViewportHeight=0,this.discardVPVDIntervalThreshold=9e4,this.vpvdMinDuration=250,this.isLoose=!1,this.isTimeTrackingEnabled=!1,this.latestTimeTrackingTimestamp=0,this.maxScrollPosition=0,this.minSizeToBeVisible=0,this.readStoryIDs={},this.relaxedMinSize=!1,this.trackingHooks=!1,this.vpvdDebug=!1,this.vpvDebug=!1,this.enableAdsAllocationIntegrityLogging=!1}var c=a.prototype;c.getDataFromConfig=function(a){g(0,2199)};c.getStoryID=function(a){g(0,2200)};c.getDataToLog=function(a){g(0,2201)};c.sendDataToLog=function(a){g(0,2202)};c.getTimeout=function(){g(0,2203)};c.getAllStories=function(){g(0,2204)};c.init=function(c){var d=this;this.isLoose=!!c.is_loose;this.relaxedMinSize=!!c.relaxed_min_size;this.vpvDebug=!!c.vpv_debug;this.isTimeTrackingEnabled=b("gkx")("985697");this.vpvdMinDuration=c.vpvd_min_duration||250;var e=a.shouldRunTrackingAfterTTI();b("MPopoverVisiblityTracker").init();e||(this.cachedViewportHeight=b("MViewport").getHeight());this.getDataFromConfig(c);this.maxScrollPosition=0;this.readStoryIDs=this.getCachedReadStoryIDs()||{};this.$2=[b("Stratcom").listen("m:page:unload",null,this.onUnload.bind(this)),b("Stratcom").listen("m:viewport:update-complete",null,function(){d.cachedViewportHeight=b("MViewport").getHeight()})];c.triggerOverride?this.$2=this.$2.concat(c.triggerOverride.map(function(a){var c=a[0];a=a[1];return b("Stratcom").listen(c,a,d.queueLogAction.bind(d))})):this.$2.push(b("Stratcom").listen("scroll",null,this.queueLogAction.bind(this)));if(this.isTimeTrackingEnabled){this.$2.push((c=b("Visibility")).addListener(c.VISIBLE,function(){return d.startVpvTracking()}));this.$2.push(c.addListener(c.HIDDEN,function(){return d.stopVpvTracking()}))}this.$2.push(b("Stratcom").listen("m:newsfeed:popup-visible",null,function(){d.stopVpvTracking()}),b("Stratcom").listen("m:newsfeed:popup-hidden",null,function(){d.startVpvTracking()}));e?b("onAfterTTI")(function(){d.startVpvTracking()},!1):(this.startVpvTracking(),b("NavigationMetrics").addRetroactiveListener(b("NavigationMetrics").Events.EVENT_OCCURRED,function(a,c){a=c.event;a==="tti"&&(d.startVpvTracking(),b("NavigationMetrics").removeCurrentListener())}))};c.getFBFeedLocation=function(){return-1};c.unitTestOnlyGetListeners=function(){return[].concat(this.$2)};c.getCachedReadStoryIDs=function(){return null};c.getMinSizeToBeVisible=function(a){if(!this.relaxedMinSize)return i;a="getBoundingClientRect"in a?a.getBoundingClientRect().height:b("Vector").getDim(a).y;return Math.min(i,a*.5)};c.startVpvTracking=function(){this.isTimeTrackingEnabled?this.startRecordingTimeTrackingData():this.fireEvent()};c.stopVpvTracking=function(){this.isTimeTrackingEnabled?this.stopRecordingTimeTrackingData():this.fireEvent()};c.fireEvent=function(){if(b("VisibilityTrackingHelper").isSnippetFlyoutVisible())return;var a=this.getAllStoriesInView();for(var c=0;c<a.length;c++){var d=a[c],e=this.getStoryID(d);if(!e||e in this.readStoryIDs)continue;this.readStoryIDs[e]=!0;this.sendDataToLog(this.getDataToLog(d));if(this.vpvDebug){e=b("DOM").scry(d,"div")[0];e&&b("Style").set(e,"background-color","#fffbe2")}this.markStoryRead(d);this.fireStoryVisibleHandlers(d)}};c.fireStoryVisibleHandlers=function(a){(j.get(a)||[]).forEach(function(a){return a()}),j["delete"](a)};c.markStoryRead=function(a){};c.queueLogAction=function(){var a=this;this.isLoose?this.$3||(this.$3=b("setTimeoutAcrossTransitions")(function(){a.maxScrollPosition=Math.max(a.maxScrollPosition,b("MViewport").getScrollTop()),a.startVpvTracking(),a.$3=null},100)):(window.clearTimeout(this.$1),this.$1=b("setTimeoutAcrossTransitions")(function(){a.startVpvTracking()},this.getTimeout()))};c.getTimetrackingDataToLog=function(c){var d=b("DOM").scry(c.story,"*","data-is-cta").map(function(a){a=b("DataAttributeUtils").getDataFt(a);a=a&&JSON.parse(a);return a&&a.cta_types}).filter(function(a){return!!a});this.cachedViewportHeight===0&&a.shouldRunTrackingAfterTTI()&&(this.cachedViewportHeight=b("MViewport").getHeight());return{evt:h,fbfeed_location:this.getFBFeedLocation(),story_height:c.story_height,viewport_height:this.cachedViewportHeight,vpvd_start_timestamp:c.evp_ts/1e3,vpvd_time_delta:Math.round(c.vpvd||0),cta_types:d}};c.recordTimeStoryWasInView=function(a){if(this.isTimeTrackingEnabled&&a.vpvd>=this.vpvdMinDuration){var c=this.getTimetrackingDataToLog(a);if(typeof c!=="string"){a=b("DataAttributeUtils").getDataFt(a.story);a&&(c=babelHelpers["extends"]({},c,b("FBJSON").parse(a,e.id)))}this.sendTimetrackingDataToLog(c)}};c.startRecordingTimeTrackingData=function(){this.$4(!1)};c.stopRecordingTimeTrackingData=function(){this.$4(!0)};c.$4=function(a){this.activeStories||(this.activeStories={});var b=Date.now();this.latestTimeTrackingTimestamp||(this.latestTimeTrackingTimestamp=b);var c=this.getAllStoriesInViewVpvd();this.updateVPVDurations(b);if(this.debugConsole){var d=Object.values(this.activeStories);d.length&&(console.table&&console.table(d))}d=this.updateActiveStories(c,b);this.debugConsole&&(d.length&&(console.table&&console.table(d)));this.recordVPVDurations(c,a);this.latestTimeTrackingTimestamp=a?0:b};c.updateVPVDurations=function(a){var b=a-this.latestTimeTrackingTimestamp;if(b>this.discardVPVDIntervalThreshold)return;b=a-this.latestTimeTrackingTimestamp;for(var c in this.activeStories)Object.prototype.hasOwnProperty.call(this.activeStories,c)&&(this.activeStories[c].vpvd+=b)};c.isVisible=function(a,b){for(var c=0;c<b.length;c++)if(this.getStoryID(b[c])===a)return!0;return!1};c.recordVPVDurations=function(a,b){this.recordVPVDurationsInternal(a,b)};c.recordVPVDurationsInternal=function(a,b){for(var c in this.activeStories)Object.prototype.hasOwnProperty.call(this.activeStories,c)&&((b||!this.isVisible(c,a))&&(this.recordTimeStoryWasInView(this.activeStories[c]),delete this.activeStories[c]))};c.updateActiveStories=function(a,b){var c=[];for(var d=0;d<a.length;d++){var e=this.getStoryID(a[d]);if(!e)break;e in this.activeStories||(this.activeStories[e]={evp_ts:b,story:a[d],vpvd:0,story_height:a[d].offsetHeight},c.push(this.activeStories[e]));this.activeStories[e].ts=b}return c};c.getAllStoriesInView=function(a){a===void 0&&(a=!1);return this.getAllStoriesInViewInternal(a,this.isLoose)};c.getAllStoriesInViewVpvd=function(){return this.getAllStoriesInViewInternal(!1,!1)};c.getAllStoriesInViewInternal=function(a,c){a===void 0&&(a=!1);c===void 0&&(c=!0);var d=[],e=this.getAllStories(),f=b("MViewport").getScrollTop(),g=b("MViewport").getHeight(),h=g+this.maxScrollPosition-f;for(var i=0;i<e.length;i++){var j=e[i],k=this.getStoryBounds(f,j),l=k.top;k=k.bottom;if(!l&&!k)continue;var m=this.getMinSizeToBeVisible(j);if(!c&&l>g-m)break;m=!c&&l<=g-m&&k>=m||c&&l<h;a&&(k<0||l>g)&&(m=!1);m&&d.push(j)}return d};c.getStoryBounds=function(a,c){if("getBoundingClientRect"in c){var d=c.getBoundingClientRect();return{bottom:d.bottom,top:d.top}}else{d=b("Vector").getPos(c).y-a;return{top:d,bottom:d+b("Vector").getDim(c).y}}};c.cleanup=function(){this.$2.forEach(function(a){return a.remove()}),this.$2=[],j.clear()};c.onUnload=function(){this.stopVpvTracking(),this.cleanup()};c.sendTimetrackingDataToLog=function(a){this.sendDataToLog(a)};a.shouldRunTrackingAfterTTI=function(){return b("MHome").isHome(location.href)&&b("gkx")("676812")};a.addStoryVisibleHandler=function(a,b){j.set(a,[].concat(j.get(a)||[],[b]));return{remove:function(){j.set(a,(j.get(a)||[]).filter(function(a){return a!==b}))}}};return a}();e.exports=a}),null);
__d("MCommentViewportTracking",["Banzai","DataStore","DOM","FBJSON","MParent","MViewportTracking","Stratcom","StratcomManager","compactArray","gkx","onAfterTTI"],(function(a,b,c,d,e,f){"use strict";var g=null,h={m_group_stories_container:"group",m_newsfeed_stream:"",m_story_permalink_view:"",structured_composer_async_container:"user",root:""};a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}c.loadedReplies=function(){b("Stratcom").invoke("m:commentViewportTracking:loadedReplies")};c.loadedComments=function(){g&&g.isTimeTrackingEnabled&&g.startRecordingTimeTrackingData()};c.singleton=function(a){if(!g){a={triggerOverride:[["scroll",null],["m:commentViewportTracking:loadedReplies",null],["m:feed-ufi-flyout:comments-displayed",null],["m:ufi:live-comments:render",null],["m:ufi:live-comments:new-comment",null],["m:feed-ufi-flyout:reset",null],["m:page:render:complete",null]]};b("StratcomManager").enableDispatch(document,"scroll");g=new c();g.init(a);g.debugConsole;g.isTimeTrackingEnabled&&(b("MViewportTracking").shouldRunTrackingAfterTTI()?b("onAfterTTI")(function(){g instanceof c&&g.startRecordingTimeTrackingData()},!1):g.startRecordingTimeTrackingData());b("Stratcom").listen("m:page:unload",null,function(){g=null,b("Stratcom").removeCurrentListener()})}};c.registerFlyout=function(a,b){var c;g&&(g.debugConsole,g.streamRoot=a);h=babelHelpers["extends"]((c={},c[a.id]=b||"",c),h)};var d=c.prototype;d.getDataFromConfig=function(){this.debugConsole=b("gkx")("676811"),this.isTimeTrackingEnabled=!0,this.idle_timeout=5e3,this.min_duration_to_log=100,this.min_visible_size=200,this.relaxedMinSize=!0};d.__getRootNode=function(){this.streamRoot||(this.streamRoot=b("compactArray")(Object.keys(h).map(function(a){return document.getElementById(a)}))[0]||null);return this.streamRoot};d.__getStaticTemplateRootNode=function(){this.staticElementRoot||(this.staticElementRoot=document.getElementById("static_templates"));return this.staticElementRoot};d.getAllStories=function(){var a=this.__getRootNode();if(!a)return[];a=b("DOM").scry(this.__getRootNode(),"div","comment-body");return this.__getStaticTemplateRootNode()?a.concat(b("DOM").scry(this.__getStaticTemplateRootNode(),"div","comment-body")):a};d.getTimeout=function(){return this.min_duration_to_log};d.getDataToLog=function(a){return{}};d.getStoryID=function(a){var c=a.getAttribute("data-commentid");return!c?String(b("DataStore").get(a,"token"))||null:c};d.getContainerModule=function(){var a=this.__getRootNode();return!a||!(a.id in h)?"other":h[a.id]};d.getTimetrackingDataToLog=function(a){var c=a.story,d;try{var f=b("MParent").bySigil(a.story,"story-div")||b("MParent").bySigil(a.story,"m-feed-single-story");f&&(d=b("FBJSON").parse(f.getAttribute("data-ft"),e.id))}catch(a){}return{comment_id:this.getStoryID(c),duration_ms:Math.round(a.vpvd),container_module:this.getContainerModule(),mf_story_key:d?d.mf_story_key||d.top_level_post_id:null}};d.sendDataToLog=function(a){if(a.comment_id){this.debugConsole;var c=b("Banzai").isEnabled("comment_vpv_vital")?b("Banzai").VITAL:void 0;b("Banzai").post("comment_vpvd",a,c)}};return c}(b("MViewportTracking"));e.exports=a}),null);
__d("AccessibilityWebAssistiveTechTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1={}}var c=a.prototype;c.log=function(){b("GeneratedLoggerUtils").log("logger:AccessibilityWebAssistiveTechLoggerConfig",this.$1,b("Banzai").BASIC)};c.logVital=function(){b("GeneratedLoggerUtils").log("logger:AccessibilityWebAssistiveTechLoggerConfig",this.$1,b("Banzai").VITAL)};c.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:AccessibilityWebAssistiveTechLoggerConfig",this.$1,{signal:!0})};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setIndicatedBrowsers=function(a){this.$1.indicated_browsers=b("GeneratedLoggerUtils").serializeVector(a);return this};c.setIsVirtualCursorAction=function(a){this.$1.is_virtual_cursor_action=a;return this};c.setTime=function(a){this.$1.time=a;return this};c.setVC=function(a){this.$1.vc=a;return this};c.setWeight=function(a){this.$1.weight=a;return this};c.updateExtraData=function(a){a=b("nullthrows")(b("GeneratedLoggerUtils").serializeMap(a));b("GeneratedLoggerUtils").checkExtraDataFieldNames(a,g);this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.addToExtraData=function(a,b){var c={};c[a]=b;return this.updateExtraData(c)};return a}();var g={indicated_browsers:!0,is_virtual_cursor_action:!0,time:!0,vc:!0,weight:!0};e.exports=a}),null);
__d("MPageTitle",[],(function(a,b,c,d,e,f){f.setTitle=function(a){document.title=a}}),null);
__d("VirtualCursorStatus",["Event","UserAgent","emptyFunction","setImmediate"],(function(a,b,c,d,e,f){var g=null,h=null;function i(){h||(h=b("Event").listen(window,"blur",function(){g=null,j()}))}function j(){h&&(h.remove(),h=null)}function a(a){g=a.keyCode,i()}function c(){g=null,j()}if(typeof window!=="undefined"&&window.document&&window.document.createElement){d=document.documentElement;if(d)if(d.addEventListener)d.addEventListener("keydown",a,!0),d.addEventListener("keyup",c,!0);else if(d.attachEvent){f=d.attachEvent;f("onkeydown",a);f("onkeyup",c)}}var k={isKeyDown:function(){return!!g},getKeyDownCode:function(){return g}},l=!1,m=!1,n=null,o=!1;function p(a){var c=new Set(),d=k.isKeyDown(),e=a.clientX,f=a.clientY,g=a.isPrimary,h=a.isTrusted,i=a.offsetX,j=a.offsetY,n=a.pointerType,o=a.mozInputSource,p=a.WEBKIT_FORCE_AT_MOUSE_DOWN,q=a.webkitForce;a=a.target;var r=a.clientWidth;a=a.clientHeight;e===0&&f===0&&i>=0&&j>=0&&m&&h&&o==null&&c.add("Chrome");l&&m&&!d&&q!=null&&q<p&&i===0&&j===0&&o==null&&c.add("Safari-edge");e===0&&f===0&&i<0&&j<0&&m&&o==null&&c.add("Safari-old");!l&&!m&&d&&g===!1&&h&&n===""&&e===0&&f===0&&i===0&&j===0&&o==null;!l&&!m&&!d&&h&&b("UserAgent").isBrowser("IE >= 10")&&o==null&&(e<0&&f<0?c.add("IE"):(i<0||i>r)&&(j<0||j>a)&&c.add("MSIE"));o===0&&h&&c.add("Firefox");return c}function q(){l=!0,b("setImmediate")(function(){l=!1})}function r(){m=!0,b("setImmediate")(function(){m=!1})}function s(a,c){n===null&&(n=p(a));o=n.size>0;a=a.target.getAttribute("data-accessibilityid")==="virtual_cursor_trigger";c(o,n,a);b("setImmediate")(function(){o=!1,n=null})}d={isVirtualCursorTriggered:function(){return o},add:function(a,c){c===void 0&&(c=b("emptyFunction"));var d=function(a){return s(a,c)};a.addEventListener("click",d);var e=b("Event").listen(a,"mousedown",q),f=b("Event").listen(a,"mouseup",r);return{remove:function(){a.removeEventListener("click",d),e.remove(),f.remove()}}}};e.exports=d}),null);
__d("AccessibilityWebVirtualCursorClickLogger",["AccessibilityWebAssistiveTechTypedLogger","VirtualCursorStatus"],(function(a,b,c,d,e,f){a={init:function(a){var c=this;a.forEach(function(a){b("VirtualCursorStatus").add(a,c._log)},this)},_log:function(a,c,d){d===void 0&&(d=!1),a&&new(b("AccessibilityWebAssistiveTechTypedLogger"))().setIndicatedBrowsers(c).setIsVirtualCursorAction(d).log()}};e.exports=a}),null);
__d("PerfFalcoEvent",["FalcoLoggerInternal"],(function(a,b,c,d,e,f){"use strict";a=b("FalcoLoggerInternal").create("perf");e.exports=a}),null);
__d("performanceNavigationStart",["performance"],(function(a,b,c,d,e,f){var g;if((g||(g=b("performance"))).now)if((g||(g=b("performance"))).timing&&(g||(g=b("performance"))).timing.navigationStart)a=function(){return(g||(g=b("performance"))).timing.navigationStart};else{if(typeof window._cstart==="number")a=function(){return window._cstart};else{var h=Date.now();a=function(){return h}}a.isPolyfilled=!0}else a=function(){return 0},a.isPolyfilled=!0;e.exports=a}),null);
__d("PerfXSharedFields",[],(function(a,b,c,d,e,f){var g={addCommonValues:function(a){navigator&&navigator.hardwareConcurrency!==void 0&&(a.num_cores=navigator.hardwareConcurrency);navigator&&navigator.deviceMemory&&(a.ram_gb=navigator.deviceMemory);navigator&&navigator.connection&&(typeof navigator.connection.downlink==="number"&&(a.downlink_megabits=navigator.connection.downlink),typeof navigator.connection.effectiveType==="string"&&(a.effective_connection_type=navigator.connection.effectiveType),typeof navigator.connection.rtt==="number"&&(a.rtt_ms=navigator.connection.rtt));return a},getCommonData:function(){var a={};g.addCommonValues(a);return a}};e.exports=g}),null);
__d("QuickLogConfigHelper",["QuickLogConfig"],(function(a,b,c,d,e,f){a=function(){"use strict";function a(){}var c=a.prototype;c.getEventDetails=function(a){return b("QuickLogConfig").qpl_events[a]};return a}();e.exports=new a()}),null);
__d("QuickPerformanceLogger",["requireCond","Arbiter","Bootloader","Env","FBLogger","cr:682175","cr:1367102","PerfFalcoEvent","PerfXSharedFields","QuickLogConfig","QuickLogConfigHelper","Random","Run","WebStorage","forEachObject","gkx","mapObject","performanceAbsoluteNow","performanceNavigationStart"],(function(a,b,c,d,e,f){"use strict";var g,h,i,j,k=(g||(g=b("performanceAbsoluteNow")))(),l="qpl";a=function(){function a(){var a=this;this.$1=new Map();this.$2={};this.$3=100;this.$5=1;this.$6=new Map();b("Run").onUnload(function(){a.$7(),a.$8(706,{respectUnloadPolicy:!0,timestamp:a.currentTimestamp()})});this.$9();this.initQplFlipperPlugin()}var c=a.prototype;c.$9=function(){var a=this,c=(h||(h=b("WebStorage"))).getSessionStorageForRead();if(!c){this.$10("_loadSavedState","sessionStorage is not available");return}var d=c.getItem(l);if(d==null)return;c.removeItem(l);c=JSON.parse(d);if(c==null){this.$10("_loadSavedState","Saved state failed to deserialize");return}if(c.markers==null||c.markers.length===0){this.$10("_loadSavedState","No saved markers found");return}c.markers.forEach(function(b){var c=b[0],d=b[1];b=b[2];a.$11(c,d,b);a.$10("_loadSavedState","Marker "+c+" (instanceKey: "+d+") resumed")})};c.$7=function(){var a=this,c=[];this.$1.forEach(function(a,b){a.forEach(function(a,d){a.resumeAfterNavigation===!0&&(delete a.resumeAfterNavigation,c.push([b,d,a]))})});if(c.length>0){var d={markers:c},e=(h||(h=b("WebStorage"))).getSessionStorage();e=h.setItemGuarded(e,l,JSON.stringify(d));e&&(c.forEach(function(b){var c=b[0];b=b[1];a.markerEnd(c,96,b)}),this.$10("_storeSavedState","Failed to store saved state: "+e.message),b("FBLogger")("qpl").catching(e).warn("Failed to store QPL state: "+JSON.stringify(d,null,2)));c.forEach(function(b){var c=b[0];b=b[1];a.$12(c,b)})}};c.$13=function(a,c){if(b("QuickLogConfig").killswitch)return null;a=this.$1.get(a);if(!a)return null;a=a.get(c);return!a?null:a};c.$11=function(a,b,c){var d=this.$1.get(a);d||(d=new Map(),this.$1.set(a,d));d.set(b,c)};c.$12=function(a,b){(a=this.$1.get(a))==null?void 0:a["delete"](b)};c.markerStoreBeforeNavigation=function(a,b){b=b===void 0?{}:b;b=b.instanceKey;b=b===void 0?0:b;a=this.$13(a,b);if(!a)return;a.resumeAfterNavigation=!0};c.markerStart=function(a,c,d,e){var f,g;c===void 0&&(c=0);d===void 0&&(d=this.currentTimestamp());e=e===void 0?{}:e;var h=e.cancelOnUnload;h=h===void 0?!1:h;e=e.trackedForLoss;e=e===void 0?!1:e;if(b("QuickLogConfig").killswitch)return;this.$13(a,c)&&b("FBLogger")("qpl").blameToPreviousDirectory().warn("Duplicate QPL markerId: "+a+" & instanceKey: "+c);var i;b("cr:682175")&&(i=b("cr:682175").maybeStartTraceForQPL(a,c,d));f=(f=i)==null?void 0:f.loomProviders;g=(g=i)==null?void 0:g.traceReferenceId;this.$6.forEach(function(b){return b.onMarkerStart(a,c,d)});var j=this.$14(a),k=j[0];j=j[1];(k||g!=null)&&this.$11(a,c,{passesSampling:k,timestamp:d,sampleRate:j,points:{},cancelOnUnload:h,trackedForLoss:e});k&&e===!0&&this.$15({marker_id:27787271,action_id:0,sample_rate:1,value:0,annotations_int:{tracked_marker_id:a}});g!=null&&this.annotateMarkerString(a,"loomRefId",g,c);f!=null&&this.annotateMarkerStringArray(a,"loomProviders",Array.from(f),c)};c.markerStartFromNavStart=function(a,c){c===void 0&&(c=0);var d=b("performanceNavigationStart")();this.markerStart(a,c,d);if(b("performanceNavigationStart").isPolyfilled){d=this.$13(a,c);d&&(d.timestampIsApproximate=!0)}};c.markerAnnotate=function(a,c,d){d=d===void 0?{}:d;d=d.instanceKey;var e=d===void 0?0:d;this.$6.forEach(function(d){return b("forEachObject")(c,function(c){b("forEachObject")(c,function(b,c){d.onAnnotation(a,e,c,b)})})});d=this.$13(a,e);if(!d)return;c.string&&(d.annotations=Object.assign({},d.annotations,c.string));if(c["int"]){var f=(i||(i=b("mapObject")))(c["int"],function(a){return parseInt(a,10)});d.annotationsInt=Object.assign({},d.annotationsInt,f)}c["double"]&&(d.annotationsDouble=Object.assign({},d.annotationsDouble,c["double"]));c.bool&&(d.annotationsBool=Object.assign({},d.annotationsBool,c.bool));c.string_array&&(d.annotationsStringArray=Object.assign({},d.annotationsStringArray,c.string_array));if(c.int_array){f=(i||(i=b("mapObject")))(c.int_array,function(a){return a.map(function(a){return parseInt(a,10)})});d.annotationsIntArray=Object.assign({},d.annotationsIntArray,f)}c.double_array&&(d.annotationsDoubleArray=Object.assign({},d.annotationsDoubleArray,c.double_array));c.bool_array&&(d.annotationsBoolArray=Object.assign({},d.annotationsBoolArray,c.bool_array))};c.annotateMarkerBool=function(a,b,c,d){d===void 0&&(d=0);this.markerAnnotate(a,{bool:(a={},a[b]=c,a)},{instanceKey:d})};c.annotateMarkerBoolArray=function(a,b,c,d){d===void 0&&(d=0);this.markerAnnotate(a,{bool_array:(a={},a[b]=c,a)},{instanceKey:d})};c.annotateMarkerString=function(a,b,c,d){d===void 0&&(d=0);this.markerAnnotate(a,{string:(a={},a[b]=c,a)},{instanceKey:d})};c.annotateMarkerStringArray=function(a,b,c,d){d===void 0&&(d=0);this.markerAnnotate(a,{string_array:(a={},a[b]=c,a)},{instanceKey:d})};c.annotateMarkerInt=function(a,b,c,d){d===void 0&&(d=0);this.markerAnnotate(a,{"int":(a={},a[b]=c,a)},{instanceKey:d})};c.annotateMarkerIntArray=function(a,b,c,d){d===void 0&&(d=0);this.markerAnnotate(a,{int_array:(a={},a[b]=c,a)},{instanceKey:d})};c.annotateMarkerDouble=function(a,b,c,d){d===void 0&&(d=0);this.markerAnnotate(a,{"double":(a={},a[b]=c,a)},{instanceKey:d})};c.annotateMarkerDoubleArray=function(a,b,c,d){d===void 0&&(d=0);this.markerAnnotate(a,{double_array:(a={},a[b]=c,a)},{instanceKey:d})};c.markerPoint=function(a,b,c,d,e){d===void 0&&(d=0);e===void 0&&(e=this.currentTimestamp());this.$6.forEach(function(f){return f.onMarkerPoint(a,d,b,c,e)});var f=this.$13(a,d);if(!f)return;f.points[b]={data:c,timeSinceStart:Math.round(e-f.timestamp)}};c.markerEnd=function(a,c,d,e){d===void 0&&(d=0);e===void 0&&(e=this.currentTimestamp());Date.now();this.$6.forEach(function(b){return b.onMarkerEnd(c,a,d,e)});var f=this.$13(a,d);if(!f)return;b("cr:682175")&&b("cr:682175").maybeEndTraceForQPL(a,d,e,babelHelpers["extends"]({qpl_action:c},f.annotations,f.annotationsBool,f.annotationsInt,f.annotationsDouble,f.annotationsBoolArray,f.annotationsStringArray,f.annotationsIntArray,f.annotationsDoubleArray));if(f.passesSampling){var g=Math.round(e-f.timestamp);if(f.timestampIsApproximate!==!0){var h=f.points;g={marker_id:a,action_id:c,instance_id:d,sample_rate:f.sampleRate,method:"random_sampling",value:g,annotations:f.annotations,annotations_bool:f.annotationsBool,annotations_int:f.annotationsInt,annotations_double:f.annotationsDouble,annotations_bool_array:f.annotationsBoolArray,annotations_string_array:f.annotationsStringArray,annotations_int_array:f.annotationsIntArray,annotations_double_array:f.annotationsDoubleArray,points:Object.keys(h).map(function(a){return{name:a,timeSinceStart:h[a].timeSinceStart,data:{string:h[a].data!=null?{__key:h[a].data}:null}}}),metadata:{application_analytics:{time_since_qpl_module_init:e-k}}};f.trackedForLoss===!0&&(g.tracked_for_loss=!0);this.$15(g)}this.$4===a&&b("Arbiter").inform("qpl_debugger_finished")}this.$12(a,d)};c.markerDrop=function(a,c){c===void 0&&(c=0);this.$12(a,c);if(b("cr:682175")){var d=this.currentTimestamp();b("cr:682175").maybeEndTraceForQPL(a,c,d,{qpl_action:216})}};c.markEvent=function(a,c,d,e){e=e===void 0?{}:e;var f=e.timestamp;f=f===void 0?this.currentTimestamp():f;e=e.annotations;if(b("QuickLogConfig").killswitch)return;var g=this.$14(a),h=g[0];g=g[1];if(!h)return;h=typeof e==="function"?e():e;this.$15({marker_id:a,action_id:0,instance_id:0,sample_rate:g,method:"random_sampling",value:0,da_type:c,da_level:d,annotations:h==null?void 0:h.string,annotations_int:h==null?void 0:h["int"],annotations_double:h==null?void 0:h["double"],annotations_bool:h==null?void 0:h.bool,annotations_string_array:h==null?void 0:h.string_array,annotations_int_array:h==null?void 0:h.int_array,annotations_double_array:h==null?void 0:h.double_array,annotations_bool_array:h==null?void 0:h.bool_array,metadata:{application_analytics:{time_since_qpl_module_init:f-k}}})};c.$8=function(a,b){var c=this;b=b===void 0?{}:b;var d=b.timestamp,e=b.respectUnloadPolicy;this.$1.forEach(function(b,f){b.forEach(function(b,g){(!e||b.cancelOnUnload===!0)&&c.markerEnd(f,a,g,d)})})};c.dropAllMarkers=function(){this.$1.clear()};c.setAlwaysOnSampleRate=function(a,b){this.$2[a]=b};c.currentTimestamp=function(){return(g||(g=b("performanceAbsoluteNow")))()};c.$14=function(a){var c;if((j||(j=b("Env"))).enable_qplinspector===!0||typeof window.__je2e_recordQPLMarker==="function"||this.$4===a)return[!0,1];c=(c=b("QuickLogConfigHelper").getEventDetails(a))!=null?c:{sampleRate:0};c=(a=(a=this.$2[a])!=null?a:c.sampleRate)!=null?a:this.$3;a=b("Random").coinflip(c);return[a,c]};c.$15=function(a){var c=this.$16(a);typeof window.__je2e_recordQPLMarker==="function"&&window.__je2e_recordQPLMarker(a);(j||(j=b("Env"))).enable_qplinspector===!0&&b("Bootloader").loadModules(["QPLInspector"],function(a){a.appendLog(c)},"QuickPerformanceLogger");b("gkx")("708253")?b("PerfFalcoEvent").logImmediately(function(){return c}):b("PerfFalcoEvent").log(function(){return c})};c.$16=function(a){var c=b("PerfXSharedFields").getCommonData();a.metadata=babelHelpers["extends"]({},a.metadata,{memory_stats:{total_mem:c.ram_gb?c.ram_gb*1073741824:null},network_stats:{downlink_megabits:c.downlink_megabits,network_subtype:c.effective_connection_type,rtt_ms:c.rtt_ms}});return a};c.$10=function(a,b,c){};c.enableDebug=function(a){this.$4=parseInt(a,10)};c.disableDebug=function(){this.$4=null};c.addListener=function(a){var b=this,c=this.$5++;this.$6.set(c,a);return{dispose:function(){b.$6["delete"](c)}}};c.initQplFlipperPlugin=function(){b("cr:1367102")!=null&&this.addListener(b("cr:1367102").qplFlipperPlugin.listener())};return a}();e.exports=new a()}),null);